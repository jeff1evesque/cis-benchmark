## CIS Ubuntu 14.04 LTS Server Benchmark
## v2.0.0 - 09-30-2016                                                          
##
## Description: this file is autogenerated by puppet, and contains the
##              audit.rules, which will be loaded by the audit daemon's init
##              script whenever the daemon is started.
##

<% if @cis_4_2_2_2 %>
## CIS 4.2.2.2 Ensure logging is configured (Not Scored)
log { source(src); source(chroots); filter(f_console); destination(console); };
log { source(src); source(chroots); filter(f_console); destination(xconsole); };
log { source(src); source(chroots); filter(f_newscrit); destination(newscrit); };
log { source(src); source(chroots); filter(f_newserr); destination(newserr); };
log { source(src); source(chroots); filter(f_newsnotice); destination(newsnotice); };
log { source(src); source(chroots); filter(f_mailinfo); destination(mailinfo); };
log { source(src); source(chroots); filter(f_mailwarn); destination(mailwarn); };
log { source(src); source(chroots); filter(f_mailerr); destination(mailerr); };
log { source(src); source(chroots); filter(f_mail); destination(mail); };
log { source(src); source(chroots); filter(f_acpid); destination(acpid); flags(final); };
log { source(src); source(chroots); filter(f_acpid_full); destination(devnull);
flags(final); };
log { source(src); source(chroots); filter(f_acpid_old); destination(acpid);
flags(final); };
log { source(src); source(chroots); filter(f_netmgm); destination(netmgm);
flags(final); };
log { source(src); source(chroots); filter(f_local); destination(localmessages); };
log { source(src); source(chroots); filter(f_messages); destination(messages); };
log { source(src); source(chroots); filter(f_iptables); destination(firewall); };
log { source(src); source(chroots); filter(f_warn); destination(warn); };
<% end %>

<% if @cis_4_2_2_4 %>
## CIS 4.2.2.4 Ensure syslog-ng is configured to send logs to a remote log host (Scored)
destination logserver { tcp("<% @centralized_log_host %>" port(514)); };
log { source(src); destination(logserver); };
<%end %>

<% if @cis_4_2_2_5 %>
## CIS 4.2.2.5 Ensure remote syslog-ng messages are only accepted on designated log hosts (Not Scored)
source net{ tcp(); };
destination remote { file("/var/log/remote/${FULLHOST}-log"); };
log { source(net); destination(remote); };
<%end %>
