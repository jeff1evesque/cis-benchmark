## CIS Ubuntu 14.04 LTS Server Benchmark
## v2.0.0 - 09-30-2016
##
## Description: this file is autogenerated by puppet, and sets a hard limit on
##              core dumps.
##
## /etc/sysctl.conf - Configuration file for setting system variables
## See /etc/sysctl.d/ for additional system variables.
## See sysctl.conf (5) for information.
##

#kernel.domainname = example.com

## Uncomment the following to stop low-level messages on console
#kernel.printk = 3 4 1 3

###############################################################################
##
## Functions previously in netbase: turn on Source Address Verification in all
##                                  interfaces to prevent spoofing attacks.
##

## Uncomment the two lines to enable Spoof protection (reverse-path filter)
#net.ipv4.conf.default.rp_filter=1
#net.ipv4.conf.all.rp_filter=1

##
## Uncomment to enable TCP/IP SYN cookies (http://lwn.net/Articles/277146/)
##
## Note: This may impact IPv6 TCP sessions too
##
#net.ipv4.tcp_syncookies=1

## Uncomment the next line to enable packet forwarding for IPv4
#net.ipv4.ip_forward=1

##
## Uncomment to enable packet forwarding for IPv6, which disables Stateless
## Address Autoconfiguration based on Router Advertisements for this host.
##
#net.ipv6.conf.all.forwarding=1


###############################################################################
##
## Additional settings: these settings can improve the network security of the
## host, and prevent against some network attacks including spoofing attacks
## as well as the man in the middle attacks through redirection. However, some
## network environments, require that these settings are disabled so review and
## enable them as needed.
##

## Do not accept ICMP redirects (prevent MITM attacks)
#net.ipv4.conf.all.accept_redirects = 0
#net.ipv6.conf.all.accept_redirects = 0

##
## Accept ICMP redirects only for gateways listed in our default
## gateway list (enabled by default)
##
# net.ipv4.conf.all.secure_redirects = 1

## Do not send ICMP redirects (we are not a router)
#net.ipv4.conf.all.send_redirects = 0

## Do not accept IP source route packets (we are not a router)
#net.ipv4.conf.all.accept_source_route = 0
#net.ipv6.conf.all.accept_source_route = 0

## Log Martian Packets
#net.ipv4.conf.all.log_martians = 1

<% if @cis_1_5_1 %>
## Set hard limit on core dumps
fs.suid_dumpable = 0
<% end %>

<% if @cis_1_5_3 %>
## Ensure address space layout randomization (ASLR) is enabled
kernel.randomize_va_space = 2
<% end %>
