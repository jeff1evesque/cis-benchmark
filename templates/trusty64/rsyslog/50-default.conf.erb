## CIS Ubuntu 14.04 LTS Server Benchmark
## v2.0.0 - 09-30-2016
##
## Description: this file is autogenerated by puppet, and contains
##              default configurations for rsyslog. Specifically, this
##              file is included by the main rsyslog configuration, located
##              at /etc/rsyslog.conf.
##

<% if @cis_4_2_1_2 %>
## CIS Ensure logging is configured (Not Scored)
*.emerg                    :omusrmsg:*
mail.*                     -/var/log/mail
mail.info                  -/var/log/mail.info
mail.warn                  -/var/log/mail.warn
mail.err                   /var/log/mail.err
news.crit                  -/var/log/news/news.crit
news.err                   -/var/log/news/news.err
news.notice                -/var/log/news/news.notice
*.=warning;*.=err          -/var/log/warn
*.crit                     /var/log/warn
*.*;mail.none;news.none    -/var/log/messages
local0,local1.*            -/var/log/localmessages
local2,local3.*            -/var/log/localmessages
local4,local5.*            -/var/log/localmessages
local6,local7.*            -/var/log/localmessages
<% end %>

<% if @cis_4_2_1_4 %>
## CIS Ensure rsyslog is configured to send logs to a remote log host (Scored)
*.* @@<%= @centralized_log_host %>
<% end %>

<% if @cis_4_2_1_5 %>
## CIS 4.2.1.5 Ensure remote rsyslog messages are only accepted on designated log hosts. (Not Scored)
$ModLoad imtcp.so
$InputTCPServerRun 514
<% end %>

## General
auth,authpriv.*            /var/log/auth.log
*.*;auth,authpriv.none-    /var/log/syslog
kern.*                     -/var/log/kern.log

## The named pipe /dev/xconsole is for the `xconsole' utility.  To use it,
## you must invoke `xconsole' with the `-file' option:
## 
##    $ xconsole -file /dev/xconsole [...]
##
## NOTE: adjust the list below, or you'll go crazy if you have a reasonably
##      busy site..
##
daemon.*;mail.*;\
	news.err;\
	*.=debug;*.=info;\
	*.=notice;*.=warn	|/dev/xconsole
