## CIS Ubuntu 14.04 LTS Server Benchmark
## v2.0.0 - 09-30-2016
##
## Description: this file is autogenerated by puppet, and contains password
##              creation related configurations.
##

## per-package modules (the "Primary" block)
password	requisite	pam_pwquality.so	try_first_pass	retry=3

## fallback if no module succeeds
password	requisite	pam_deny.so

## prime the stack with a positive return value if there isn't one already;
## this avoids us returning an error just because nothing sets a success code
## since the modules above will each just jump around
password	required	pam_permit.so

<% if @cis_5_3_1 %>
## CIS 5.3.1 Ensure password creation requirements are configured (Scored)
password	requisite	pam_pwquality.so	try_first_pass	retry=3
<% end %>

<% if @cis_5_3_3 %>
## CIS 5.3.3 Ensure password reuse is limited (Scored)
password	sufficient	pam_unix.so	remember=5
<% end %>

<% if @cis_5_3_4 %>
## CIS 5.3.4 Ensure password hashing algorithm is SHA-512 (Scored)
password	[success=1 default=ignore]		pam_unix.so sha512
<% end %>